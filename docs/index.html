<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Creating and significance testing LDA topics • ldatext</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Creating and significance testing LDA topics">
<meta property="og:description" content="This package complement the text package by including LDA topics in the pipeline. For more information see  &lt;https://www.r-text.org&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ldatext</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/theharmonylab/lda-pipeline/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="ldatext">ldatext<a class="anchor" aria-label="anchor" href="#ldatext"></a>
</h1></div>
<p>ldatext is an R-package based on mallet for LDA (Latent Dirichlet Allocation) Topic Modeling.</p>
<p>When using this code, please reference “Leon Ackermann &amp; Oscar Kjell (in progress). Visualizing different language formats.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"theharmonylab/ldatext"</span>, auth_token <span class="op">=</span> <span class="st">" .... "</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># see how to make your private auth token here: https://github.com/settings/tokens</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># Before open the library, consider setting this option (can increase 5000);  without it the code may ran out of memory</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>java.parameters <span class="op">=</span> <span class="st">"-Xmx5000m"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="table-of-contents">Table of Contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h2>
<ol style="list-style-type: decimal">
<li><a href="#overview">Overview</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#usage">Usage</a></li>
</ol>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The pipeline is composed of the following steps:</p>
<p><strong>1. Data Preprocessing</strong><br> The data preprocessing converts the data into a document term matrix (DTM) and removes stopwords, punctuation, etc. which is the data format needed for the LDA model.</p>
<p><strong>2. Model Training</strong><br> The model training step trains the LDA model on the DTM with a number of iterations and predefined amount of topics.</p>
<p><strong>3. Model Inference</strong><br> The model inference step uses the trained LDA model to infer the topic term distribution of the documents.</p>
<p><strong>4. Statistical Analysis</strong><br> The analysis includes the methods like linear regression, binary regression, ridge regression or correlation to analyze the relationship between the topics and the prediction variable. It is possible to control for a number of variables and to adjust the p-value for multiple comparisons.</p>
<p><strong>5. Visualization</strong><br> The visualization step creates wordclouds of the significant topics found by the statistical analysis.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>In an example where the topics are used to predict the PHQ-9 score, the pipeline can be run as follows:</p>
<p><strong>1. Data Preprocessing</strong><br> To preprocess the data, run the following command:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"data.csv"</span><span class="op">)</span></span>
<span><span class="va">dtm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ldaDtm.html">ldaDtm</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>,</span>
<span>              id_col <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>              data_col <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span></span></code></pre></div>
<p>The function takes the following arguments: - <code>data</code> (tibble): the data frame containing the text data - <code>id_col</code> (string): the name of the column containing the unique id - <code>data_col</code> (string): the name of the column containing the text data - <code>ngram_window</code> (list): the minimum and maximum n-gram length, e.g. <code>c(1,3)</code> - <code>stopwords</code> (stopwords): the stopwords to remove, e.g. <code>stopwords::stopwords("en", source = "snowball")</code> - <code>removalword</code> (string): the word to remove - <code>occ_rate</code> (integer): the rate of occurence of a word to be removed - <code>removal_mode</code> (string): the mode of removal (“most” or “least”) - <code>removal_rate_most</code> (integer): the rate of most frequent words to be removed - <code>removal_rate_least</code> (integer): the rate of least frequent words to be removed - <code>split</code> (float): the proportion of the data to be used for training - <code>seed</code> (integer): the random seed for reproducibility - <code>save_dir</code> (string): the directory to save the results, default is “./results”, if NULL, no results are saved</p>
<p><strong>2. Model Training</strong><br> To train the LDA model, run the following command:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ldaModel.html">ldaModel</a></span><span class="op">(</span>dtm <span class="op">=</span> <span class="va">dtm</span>,</span>
<span>                  num_topics <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                  num_iterations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>The function takes the following arguments: - <code>dtm</code> (R_obj): The document term matrix. - <code>num_topics</code> (integer): The number of topics to be created. - <code>num_top_words</code> (integer): The number of top words to be displayed per topic. - <code>num_iterations</code> (integer): The number of iterations to run the model for. - <code>seed</code> (integer): The seed to set for reproducibility. - <code>save_dir</code> (string): The directory to save the model. If NULL, the model will not be saved. - <code>load_dir</code> (string): The directory to load the model from. If NULL, the model will not be loaded.</p>
<p><strong>3. Model Inference</strong><br> To infer the topic term distribution of the documents, run the following command:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ldaPreds.html">ldaPreds</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>,</span>
<span>                  dtm <span class="op">=</span> <span class="va">dtm</span><span class="op">)</span></span></code></pre></div>
<p>The function takes the following arguments: - <code>model</code> (list): The trained model. - <code>num_iterations</code> (integer): The number of iterations to run the model. - <code>dtm</code> (R_obj): The document term matrix for the new document. - <code>seed</code> (integer): The seed to set for reproducibility. - <code>save_dir</code> (string): The directory to save the predictions. If NULL, the predictions will not be saved. - <code>load_dir</code> (string): The directory to load the model from. If NULL, the predictions will not be loaded.</p>
<p><strong>4. Statistical Analysis</strong><br> To analyze the relationship between the topics and the prediction variable, run the following command:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/ldaTest.html">ldaTest</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>,</span>
<span>                preds <span class="op">=</span> <span class="va">preds</span>,</span>
<span>                dtm <span class="op">=</span> <span class="va">dtm</span>,</span>
<span>                pred_var <span class="op">=</span> <span class="st">"phq9"</span>,</span>
<span>                control_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"age"</span>,<span class="va">..</span><span class="op">)</span>,</span>
<span>                test_method <span class="op">=</span> <span class="st">"linear_regression"</span><span class="op">)</span></span></code></pre></div>
<p>The function takes the following arguments: - <code>model</code> (list): The trained LDA model. - <code>preds</code> (tibble): The predictions made by the model. - <code>dtm</code> (R_obj): The document term matrix used for testing. - <code>pred_var</code> (string): The variable to be predicted, necessary only for regression or correlation tests. - <code>group_var</code> (string): The variable used to group data, necessary only for t-test. - <code>control_vars</code> (vector): Control variables to adjust for in the testing process. - <code>test_method</code> (string): The test method to use. Options include “correlation”, “t-test”, “linear_regression”, “logistic_regression”, or “ridge_regression”. - <code>seed</code> (integer): The seed to set for reproducibility. - <code>load_dir</code> (string): The directory to load the test from. If NULL, the test will not be loaded. - <code>save_dir</code> (string): The directory to save the test results. If NULL, the test will not be saved.</p>
<p><strong>5. Visualization</strong><br> To visualize the significant topics as wordclouds, run the following command:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/ldaWordclouds.html">ldaWordclouds</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>,</span>
<span>              test <span class="op">=</span> <span class="va">test</span><span class="op">)</span></span></code></pre></div>
<p>The function takes the following arguments: - <code>model</code> (list): The trained model. - <code>test</code> (list): The test results, typically containing topic distributions and associated metrics. - <code>color_negative_cor</code> (R_obj): The color gradient for negative correlations, specifying colors from low to high, default: <code>scale_color_gradient(low = "darkgreen", high = "green")</code> - <code>color_positive_cor</code> (R_obj): The color gradient for positive correlations, specifying colors from low to high, default: <code>scale_color_gradient(low = "darkred", high = "red")</code> - <code>scale_size</code> (logical): Whether to scale the size of the words in the wordcloud based on frequency or importance. - <code>plot_topics_idx</code> (vector): Indices of the topics to be plotted. - <code>p_threshold</code> (integer): The p-value threshold for determining significance in topic correlations. - <code>save_dir</code> (string): The directory where the wordclouds will be saved. - <code>figure_format</code> (string): Set the figure format, e.g., “.svg” or “.png”. - <code>seed</code> (integer): The seed for reproducibility.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/theharmonylab/lda-pipeline/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/theharmonylab/lda-pipeline" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ldatext</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Leon Ackermann <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0000-0000-0000" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Oscar Kjell <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-2728-6278" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Leon Ackermann, Oscar Kjell.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
